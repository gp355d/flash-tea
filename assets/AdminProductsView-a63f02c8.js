import{m as N,D as q}from"./DelModal-520c51c9.js";import{b as F}from"./@ckeditor-b092e1d3.js";import{S as b}from"./sweetalert2-fc38d252.js";import{aM as f,aC as a,W as c,X as e,a2 as R,U as V,bl as U,bc as D,F as E,aK as T,a3 as l,bj as L,ar as _,b8 as H,aZ as g}from"./@vue-a2e6aab2.js";import{_ as I}from"./index-8f9b4ce5.js";import{P as O}from"./PaginationView-54b25221.js";import"./bootstrap-d9a0ff4a.js";import"./@popperjs-9847b28c.js";import"./vue-71628d3f.js";import"./pinia-7d28dea6.js";import"./vue-demi-71ba0ef2.js";import"./aos-aa3ba816.js";import"./lodash.throttle-ab0b6905.js";import"./lodash.debounce-ca1b1d09.js";import"./vue-router-49be82a2.js";import"./axios-08622986.js";import"./vue-axios-58a7c26f.js";import"./vue-loading-overlay-67898897.js";import"./vee-validate-aa725db8.js";import"./@vee-validate-55db0f47.js";const{VITE_APP_URL:S,VITE_APP_PATH:$}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"leo533",BASE_URL:"/flash-tea/",MODE:"production",DEV:!1,PROD:!0},j={props:{tempProducts:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},data(){return{tempProduct:{description:"",content:""},status:{},editor:F,editorConfig:{toolbar:["heading","|","bold","italic","link"]}}},methods:{uploadFile(){const i=this.$refs.fileInput.files[0],t=new FormData;t.append("file-to-upload",i);const d=`${S}v2/api/${$}/admin/upload`;this.status.fileUploading=!0,this.$http.post(d,t,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{this.status.fileUploading=!1,n.data.success?(this.tempProduct.imageUrl=n.data.imageUrl,this.$refs.fileInput.value=""):this.$refs.fileInput.value=""}).catch(n=>{this.status.fileUploading=!1,b.fire({position:"top-end",icon:"error",title:n.response.data.message,showConfirmButton:!1,timer:1500})})}},emits:["update-data"],mixins:[N],watch:{tempProducts(){this.tempProduct=this.tempProducts,this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imageUrl||(this.tempProduct.imageUrl="")}}},z={class:"modal",id:"productModal",tabindex:"-1",ref:"modal"},K={class:"modal-dialog modal-xl"},W={class:"modal-content border-0"},X={class:"modal-header bg-dark text-white"},Z={class:"modal-title"},G={key:0},J={key:1},Q=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Y={class:"modal-body"},ee={class:"row"},te={class:"col-sm-4"},oe={class:"mb-3"},se={for:"customFile",class:"form-label"},le={key:0,class:"fas fa-spinner fa-spin"},ie={class:"mb-3"},de=e("label",{for:"imageUrl",class:"form-label"},"或 主要圖片",-1),ne=["src"],re=e("h3",{class:"mb-3"},"多圖新增",-1),ae={key:0},ce={class:"mb-3"},me=e("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),ue=["onUpdate:modelValue"],pe=["src"],_e=["onClick"],he={key:1},fe={class:"col-sm-8"},be={class:"mb-3"},Pe=e("label",{for:"title",class:"form-label"},"標題",-1),ge={class:"row"},ve={class:"mb-3 col-md-6"},ye=e("label",{for:"category",class:"form-label"},"分類",-1),Ve={class:"mb-3 col-md-6"},Ue=e("label",{for:"price",class:"form-label"},"單位",-1),we={class:"row"},ke={class:"mb-3 col-md-6"},xe=e("label",{for:"origin_price",class:"form-label"},"原價",-1),Me={class:"mb-3 col-md-6"},Ce=e("label",{for:"price",class:"form-label"},"售價",-1),Ae={class:"row"},De={class:"mb-3 col-md-6"},Ee=e("label",{for:"price",class:"form-label"},"淨重",-1),Te={class:"mb-3 col-md-6"},Ie=e("label",{for:"price",class:"form-label"},"淨重單位",-1),Be={class:"row"},Ne={class:"mb-3 col-md-6"},qe=e("label",{for:"price",class:"form-label"},"保存期限",-1),Fe={class:"mb-3 col-md-6"},Re=e("label",{for:"price",class:"form-label"},"保存期限單位",-1),Le={class:"row"},He={class:"mb-3 col-md-6"},Oe=e("label",{for:"origin_country",class:"form-label"},"產地",-1),Se=e("hr",null,null,-1),$e={class:"mb-3"},je=e("label",{for:"description",class:"form-label"},"產品描述",-1),ze={class:"mb-3"},Ke=e("label",{for:"content",class:"form-label"},"說明內容",-1),We={class:"mb-3"},Xe={class:"form-check"},Ze=e("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Ge={class:"modal-footer"},Je=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function Qe(i,t,d,n,o,h){var w,k,x,M,C,A;const m=f("v-field"),u=f("error-message"),P=f("ckeditor"),p=f("v-form");return a(),c("div",z,[e("div",K,[e("div",W,[e("div",X,[e("h5",Z,[d.isNew?(a(),c("span",G,"新增產品")):(a(),c("span",J,"編輯產品"))]),Q]),e("div",Y,[e("div",ee,[e("div",te,[e("div",oe,[e("label",se,[R("上傳圖片 "),(w=o.status)!=null&&w.fileUploading?(a(),c("i",le)):V("",!0)]),e("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:t[0]||(t[0]=(...r)=>h.uploadFile&&h.uploadFile(...r))},null,544)]),e("div",ie,[de,U(e("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":t[1]||(t[1]=r=>o.tempProduct.imageUrl=r)},null,512),[[D,o.tempProduct.imageUrl]])]),e("img",{class:"img-fluid",src:o.tempProduct.imageUrl,alt:""},null,8,ne),re,Array.isArray(o.tempProduct.imagesUrl)?(a(),c("div",ae,[(a(!0),c(E,null,T(o.tempProduct.imagesUrl,(r,s)=>(a(),c("div",{class:"mb-1",key:s},[e("div",ce,[me,U(e("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":B=>o.tempProduct.imagesUrl[s]=B},null,8,ue),[[D,o.tempProduct.imagesUrl[s]]])]),e("img",{class:"img-fluid",src:r,alt:""},null,8,pe),e("div",null,[e("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:()=>o.tempProduct.imagesUrl.splice(s,1)}," 刪除圖片 ",8,_e)])]))),128))])):V("",!0),!((x=(k=o.tempProduct)==null?void 0:k.imagesUrl)!=null&&x.length)||(A=o.tempProduct)!=null&&A.imagesUrl[((C=(M=o.tempProduct)==null?void 0:M.imagesUrl)==null?void 0:C.length)-1]?(a(),c("div",he,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[2]||(t[2]=()=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):V("",!0)]),e("div",fe,[l(p,null,{default:L(({errors:r})=>[e("div",be,[Pe,l(m,{id:"title",name:"標題",type:"text",class:_(["form-control",{"is-invalid":r.標題}]),placeholder:"請輸入標題",modelValue:o.tempProduct.title,"onUpdate:modelValue":t[3]||(t[3]=s=>o.tempProduct.title=s),rules:"required"},null,8,["modelValue","class"]),l(u,{name:"標題",class:"invalid-feedback"})]),e("div",ge,[e("div",ve,[ye,l(m,{id:"category",name:"分類",type:"text",class:_(["form-control",{"is-invalid":r.分類}]),placeholder:"請輸入分類",modelValue:o.tempProduct.category,"onUpdate:modelValue":t[4]||(t[4]=s=>o.tempProduct.category=s),rules:"required"},null,8,["modelValue","class"]),l(u,{name:"分類",class:"invalid-feedback"})]),e("div",Ve,[Ue,l(m,{id:"unit",name:"單位",type:"text",class:_(["form-control",{"is-invalid":r.單位}]),placeholder:"請輸入單位",modelValue:o.tempProduct.unit,"onUpdate:modelValue":t[5]||(t[5]=s=>o.tempProduct.unit=s),rules:"required"},null,8,["modelValue","class"]),l(u,{name:"單位",class:"invalid-feedback"})])]),e("div",we,[e("div",ke,[xe,l(m,{id:"origin_price",name:"原價",type:"number",min:"0",class:_(["form-control",{"is-invalid":r.原價}]),placeholder:"請輸入原價",modelValue:o.tempProduct.origin_price,"onUpdate:modelValue":t[6]||(t[6]=s=>o.tempProduct.origin_price=s),modelModifiers:{number:!0},rules:"required"},null,8,["modelValue","class"]),l(u,{name:"原價",class:"invalid-feedback"})]),e("div",Me,[Ce,l(m,{id:"price",name:"售價",type:"number",min:"0",class:_(["form-control",{"is-invalid":r.售價}]),placeholder:"請輸入售價",modelValue:o.tempProduct.price,"onUpdate:modelValue":t[7]||(t[7]=s=>o.tempProduct.price=s),modelModifiers:{number:!0},rules:"required"},null,8,["modelValue","class"]),l(u,{name:"售價",class:"invalid-feedback"})])]),e("div",Ae,[e("div",De,[Ee,l(m,{id:"price",name:"淨重",type:"number",min:"0",class:_(["form-control",{"is-invalid":r.淨重}]),placeholder:"請輸入淨重",modelValue:o.tempProduct.product_weight,"onUpdate:modelValue":t[8]||(t[8]=s=>o.tempProduct.product_weight=s),modelModifiers:{number:!0},rules:"required"},null,8,["modelValue","class"]),l(u,{name:"淨重",class:"invalid-feedback"})]),e("div",Te,[Ie,l(m,{id:"price",name:"淨重單位",type:"text",min:"0",class:_(["form-control",{"is-invalid":r.淨重單位}]),placeholder:"請輸入淨重單位",modelValue:o.tempProduct.product_unit,"onUpdate:modelValue":t[9]||(t[9]=s=>o.tempProduct.product_unit=s),rules:"required"},null,8,["modelValue","class"]),l(u,{name:"淨重單位",class:"invalid-feedback"})])]),e("div",Be,[e("div",Ne,[qe,l(m,{id:"price",name:"保存期限",type:"number",min:"0",class:_(["form-control",{"is-invalid":r.保存期限}]),placeholder:"請輸入保存期限",modelValue:o.tempProduct.product_year,"onUpdate:modelValue":t[10]||(t[10]=s=>o.tempProduct.product_year=s),modelModifiers:{number:!0},rules:"required"},null,8,["modelValue","class"]),l(u,{name:"保存期限",class:"invalid-feedback"})]),e("div",Fe,[Re,l(m,{id:"price",name:"保存期限單位",type:"text",min:"0",class:_(["form-control",{"is-invalid":r.保存期限單位}]),placeholder:"請輸入保存期限單位",modelValue:o.tempProduct.product_year_unit,"onUpdate:modelValue":t[11]||(t[11]=s=>o.tempProduct.product_year_unit=s),rules:"required"},null,8,["modelValue","class"]),l(u,{name:"保存期限單位",class:"invalid-feedback"})])]),e("div",Le,[e("div",He,[Oe,l(m,{id:"origin_country",name:"產地",type:"text",min:"0",class:_(["form-control",{"is-invalid":r.產地}]),placeholder:"請輸入產地",modelValue:o.tempProduct.product_country,"onUpdate:modelValue":t[12]||(t[12]=s=>o.tempProduct.product_country=s),rules:"required"},null,8,["modelValue","class"]),l(u,{name:"產地",class:"invalid-feedback"})])]),Se,e("div",$e,[je,l(P,{id:"description",class:"form-control",editor:o.editor,modelValue:o.tempProduct.description,"onUpdate:modelValue":t[13]||(t[13]=s=>o.tempProduct.description=s),config:o.editorConfig,placeholder:"請輸入產品描述"},null,8,["editor","modelValue","config"])]),e("div",ze,[Ke,l(P,{id:"content",class:"form-control",editor:o.editor,modelValue:o.tempProduct.content,"onUpdate:modelValue":t[14]||(t[14]=s=>o.tempProduct.content=s),config:o.editorConfig,placeholder:"請輸入說明內容"},null,8,["editor","modelValue","config"])]),e("div",We,[e("div",Xe,[U(e("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[15]||(t[15]=s=>o.tempProduct.is_enabled=s)},null,512),[[H,o.tempProduct.is_enabled]]),Ze])])]),_:1})])]),e("div",Ge,[Je,e("button",{type:"button",class:"btn btn-primary",onClick:t[16]||(t[16]=()=>i.$emit("update-data"))},"確認")])])])])],512)}const Ye=I(j,[["render",Qe]]),{VITE_APP_URL:v,VITE_APP_PATH:y}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"leo533",BASE_URL:"/flash-tea/",MODE:"production",DEV:!1,PROD:!0},et={data(){return{products:[],pagination:{},tempProducts:{imagesUrl:[]},isNew:!1,status:{fileUploading:!1}}},methods:{getProducts(i=1){const t=this.$loading.show();this.$http.get(`${v}v2/api/${y}/admin/products/?page=${i}`).then(d=>{this.products=d.data.products,this.pagination=d.data.pagination,t.hide()}).catch(d=>{b.fire({position:"top-end",icon:"error",title:d.response.data.message,showConfirmButton:!1,timer:1500}),t.hide()})},openModal(i,t){const d=this.$loading.show();if(i==="new"){this.tempProducts={imagesUrl:[]},this.isNew=!0;const n=this.$refs.productModal;d.hide(),n.openModal()}else if(i==="edit"){this.tempProducts={...t},this.isNew=!1;const n=this.$refs.productModal;d.hide(),n.openModal()}else if(i==="delete"){this.tempProducts={...t};const n=this.$refs.productsdelModal;d.hide(),n.openModal()}},updateProduct(){let i=`${v}v2/api/${y}/admin/product`,t="post";this.isNew||(i=`${v}v2/api/${y}/admin/product/${this.tempProducts.id}`,t="put");const d={data:this.tempProducts};this.$http[t](i,d).then(n=>{b.fire({position:"top-end",icon:"success",title:n.data.message,showConfirmButton:!1,timer:1500}),this.$refs.productModal.hideModal(),this.getProducts()}).catch(n=>{b.fire({position:"top-end",icon:"error",title:n.response.data.message,showConfirmButton:!1,timer:1500})})},deleteProduct(){const i=`${v}v2/api/${y}/admin/product/${this.tempProducts.id}`;this.$http.delete(i).then(t=>{b.fire({position:"top-end",icon:"success",title:t.data.message,showConfirmButton:!1,timer:1500}),this.$refs.productsdelModal.hideModal(),this.getProducts()}).catch(t=>{b.fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500})})}},components:{ProductsModal:Ye,Pagination:O,DelModal:q},mounted(){this.getProducts(),document.title=this.$route.meta.title}},tt={class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},ot=e("h1",{class:"text-center text-primary fw-bold my-2"},"商品管理",-1),st={class:"py-0"},lt={class:"text-end mt-4"},it={class:"table-responsive"},dt={class:"table mt-4"},nt=e("thead",null,[e("tr",null,[e("th",{class:"text-nowrap"},"分類"),e("th",{class:"text-nowrap"},"產品名稱"),e("th",null,"原價"),e("th",null,"售價"),e("th",{class:"text-nowrap"},"啟用狀態"),e("th",{class:"text-nowrap"},"操作行為")])],-1),rt={class:"text-nowrap"},at={class:"text-nowrap"},ct={class:"text-right"},mt={class:"text-right"},ut={class:"text-nowrap"},pt={key:0},_t={key:1},ht={class:"text-nowrap"},ft={class:"btn-group"},bt=["onClick"],Pt=["onClick"];function gt(i,t,d,n,o,h){const m=f("ProductsModal"),u=f("DelModal"),P=f("Pagination");return a(),c("main",tt,[ot,e("div",st,[e("div",lt,[e("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=()=>h.openModal("new"))}," 建立新的產品 ")]),e("div",it,[e("table",dt,[nt,e("tbody",null,[(a(!0),c(E,null,T(o.products,p=>(a(),c("tr",{key:p.id},[e("td",rt,g(p.category),1),e("td",at,g(p.title),1),e("td",ct,g(i.$filters.currency(p.origin_price)),1),e("td",mt,g(i.$filters.currency(p.price)),1),e("td",ut,[p.is_enabled?(a(),c("span",pt,"啟用")):(a(),c("span",_t,"未啟用"))]),e("td",ht,[e("div",ft,[e("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:()=>h.openModal("edit",p)}," 編輯 ",8,bt),e("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:()=>h.openModal("delete",p)}," 刪除 ",8,Pt)])])]))),128))])])]),l(m,{ref:"productModal","temp-products":o.tempProducts,"is-new":o.isNew,onUpdateData:h.updateProduct},null,8,["temp-products","is-new","onUpdateData"]),l(u,{ref:"productsdelModal","temp-items":o.tempProducts,onDeleteData:h.deleteProduct,id:1},null,8,["temp-items","onDeleteData"]),l(P,{pages:o.pagination,onEmitPages:h.getProducts},null,8,["pages","onEmitPages"])])])}const Ht=I(et,[["render",gt]]);export{Ht as default};
